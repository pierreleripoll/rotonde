{% extends "layout.html" %}
{% set active_page = 'spectacle' %}
{%block head%}
{{super()}}
  <script src="/static/color-thief.js"></script>
  <script>


    var paths = new Array({{paths|length}});
    var i =0;
    {%for path in paths%}
    paths[i] ="{{path}}" ;
    console.log(paths[i]);
    i++;
    {%endfor%}
    i=0;

    var colorThief = new ColorThief();

    function chgPhoto(){
      var image = document.getElementById("imgSpectacle");
      image.onload = function(){
        var c = colorThief.getColor(image);
        image.style.backgroundColor = 'rgb(' + [c[0],c[1],c[2]].join(',') + ')';
      }
      i++;
      if(i>=paths.length)i=0;
      image.setAttribute("src",paths[i]);


      console.log(paths[i]);
    }


    function chgColorPhoto(image){

    }


  </script>
{%endblock%}
{% block title %}{{spectacle.nom.upper()}}{% endblock %}


{% block content %}


  <div class="container">
      <div class="row">
        <div class="col-md-8 ">
          <div class="card card-eq-height">
          <div class="card-body">
            <h2 class="card-title">{{spectacle.nom.upper()}} </h2>
            {%if spectacle.auteur%}
            <h4 class="card-title">{{spectacle.auteur.upper()}} </h4>
            {%endif%}
            {%if spectacle.resume %}
            <p class="card-resume">{{spectacle.resume}}</p>
            {%endif%}
          </div>
        </div>
        </div>
        <div class="col-md-4 ">
          <div class="card card-eq-height">
          <div class="card-body">
            <h5 class="card-title">{{spectacle.directeur.upper()}} </h5>
            <p class="card-participants">Avec {{spectacle.participants}}</p>

          </div>
        </div>

      </div>
    </div>

      <div class="row">
        <div id="showImage"  class=" col-md-12 ">
              <img onclick="chgPhoto()" id="imgSpectacle" class="card-imgSpectacle" src="{{paths[0]}}">
      </div>

    </div>
  </div>

  <form action="" method="POST">
    <p> Quelles dates souhaitez vous r√©server ?</p>
    <p> Date Places Restantes </p>
    <ul>
      {%for date in dates %}
      <li>{{date.date}} {{date.placesRestantes}}
        <input type="number" id="places" name="{{date.date}}" min="0" max="{{date.placesRestantes}}"> </li>

      {% endfor %}
    </ul>
      <ul>
        <button name="submit" value="valider" type="submit">Valider</button>
         {%if session.admin == 'super' or session.pseudo == spectacle.admin%}
        <button name="submit" value="modify" type="submit">Modifier</button>
        {%endif%}
        <br></br>
      </ul>
  </form>
{% endblock %}
